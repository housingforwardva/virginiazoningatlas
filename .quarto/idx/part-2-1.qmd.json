{"title":"Population and Housing Trends","markdown":{"headingText":"Population and Housing Trends","headingAttr":{"id":"part-2-1","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n```{r}\n#| label: setup\n\n# Load necessary packages.\n\nlibrary(tidyverse)\nlibrary(tidycensus)\nlibrary(ggplot2)\nlibrary(ggiraph)\nlibrary(sf)\nlibrary(leaflet)\nlibrary(FinCal)\nlibrary(hdatools)\nlibrary(scales)\nlibrary(forcats)\nlibrary(kableExtra)\nlibrary(ggtext)\nlibrary(readr)\nlibrary(zoo)\nlibrary(patchwork)\n\n\n# Describe the Hampton Roads region. \n\n# What has the housing market been like in recent years? Use news articles and available data to summarize trends.\n\n# Use data from the VZA to summarize the number of districts involved, number of zoning ordinance pages read, and other interesting metrics.\n\n```\n\nThe [Hampton Roads Planning District Commission](https://www.hrpdcva.gov/) is comprised of 17 local governments, including ten independent cities, six counties, and the Town of Smithfield.\n\n```{r}\n#| label: fig-hr-map\n#| fig-cap: \"Hampton Roads\"\n\n# The following is a map of Hampton Roads localities including towns.\n\nhr_region <- read_rds(\"data/hr/rds/hr_region.rds\") # Load in Hampton Roads geojson as rds.\n\n# Map in leaflet.\n\nleaflet(hr_region) |> \n  addProviderTiles(providers$CartoDB.Positron) |> # Add basemap\n  addPolygons(fillColor = \"#011E41\", # Set polygon fill color.\n              weight = 1, # Set polygon outline weight.\n              color = \"white\", # Set polygon outline color.\n              fillOpacity = 0.8, # Set polygon fill color transparency.\n              popup = hr_region$Jurisdiction) # Set pop-up to jurisdiction name.\n\n```\n\n## Summary\n\n\"[Housing in Hampton Roads is less affordable than Northern Virginia, other pricey areas](https://www.vpm.org/news/2022-11-07/housing-in-hampton-roads-is-less-affordable-than-northern-virginia-other-pricey)\" by Ryan Murphy of WHRO brought major attention to the challenges faced by Hampton Roads residents. In Hampton Roads, 34 percent of households were cost-burdened in 2021, three percentage points more than households in the Washington, D.C. Metro Area (an area often cited for its unaffordability).\n\nWhile Hampton Roads may appear more affordable compared to other regions nationwide and within the Commonwealth, wage growth has not kept pace with rising housing demand. These challenges disproportionately impact renter households, including those with higher incomes.\n\n## Population Trends\n\nFrom 2010 to 2022, Hampton Roads has grown by over 85,000 new people (a five percent increase). Much of the growth in the region has been in less urban parts of the region, like James City County (+21%), Suffolk (+16%), Isle of Wight County (+14%), and Chesapeake (+14%). Some areas like Surry County (-7%) and even the City of Norfolk (-4%) had population decrease.\n\n```{r}\n#| label: fig-hr-city-pop\n#| fig-cap: \"Population change in the Hampton Roads region\"\n\n# Create a visualization that shows population change in the region by city. What localities are seeing the most growth? Which ones are seeing decline?\n\n# hr_pop <- read_rds(\"data/hr/hr_pop.rds\") |> \n#   mutate(year = as.numeric(year)) |> \n#   filter(year >= 2010) |> \n#   group_by(name_long) |>\n#   mutate(diff = value - lag(value),\n#          diff = replace_na(diff, 0)) |> \n#   mutate(run_diff = cumsum(diff))|>  \n#   filter(run_diff != 0) |> \n#   mutate(year = as.character(year)) |> \n#   mutate(type = case_when(\n#     str_detect(name_long, \"City\") ~ \"City\",\n#     TRUE ~ \"County\"\n#   )) |> \n#   filter(year == 2022)\n\nhr_pop_total <- read_rds(\"data/hr/rds/hr_pop.rds\") |> # Load in population data for Hampton Roads.\n  mutate(year = as.numeric(year)) |> # Convert the year column to a number instead of character.\n  filter(year == 2010 | year == 2022) |> # Filter for earliest and latest year.\n  select(name_long, year, value) |> # Select only needed fields.\n  pivot_wider(names_from = year, \n              values_from = value) |> \n  mutate(total_2010 = sum(`2010`),\n         total_2022 = sum(`2022`)) |> \n  mutate(change = total_2022 - total_2010) |> # Calculate change in population for entire region.\n  mutate(pchg = change/total_2010) |> # Calculate percent change in population for entire region.\n  mutate(lpchg = (`2022` - `2010`)/`2010`) |> # Calculate percent change for each locality.\n  mutate(name_long = str_remove(name_long, \" City\")) |> # Remove \" City\" from each locality.\n  mutate(name_long = case_when( # Add back in City to James City County.\n    name_long == \"James County\" ~ \"James City County\",\n    TRUE ~ name_long\n  ))\n         \nggplot(hr_pop_total, # Read in the data.\n                  aes(x = reorder(name_long, lpchg), # Plot the x-axis.\n                      y = lpchg, # Plot the y-axis.\n                      fill = lpchg)) + # Set the variable that will be colored.\n  geom_col(position = \"dodge\") + # Set as a bar chart. \n  geom_text(aes(label = percent(lpchg, 2), hjust = ifelse(lpchg >= 0, 0, 1), color = lpchg)) +\n  coord_flip() +\n  theme_hfv() + # Apply custom HFV theme.\n  add_zero_line(\"y\") + # Add darker zero intercept line for emphasis.\n  labs(title = \"Percent population change in the Hampton Roads region\",\n       subtitle = \"From 2010 to 2022\",\n       caption = \"**Source:** U.S. Census Bureau, Population Estimates Program (PEP).\") +\n  scale_y_continuous(label = percent_format(), expand = expansion(mult = c(0.05, 0.1))) + \n  scale_fill_gradientn(colours = c(\"#ADDCB1\", \"#46A88F\", \"#207A88\", \"#0F1A4E\")) +\n  scale_color_gradientn(colours = c(\"#ADDCB1\", \"#46A88F\", \"#207A88\", \"#0F1A4E\"))\n\n```\n\nIn most jurisdictions across Hampton Roads, households have been getting smaller. From 2010 to 2021, the largest increases in households were among 1- and 2-person households, especially in Virginia Beach and Chesapeake. Three-person and 4-person or more households saw little growth, and in many cases declines during this time frame. Smaller household sizes have been [linked to growing financial challenges](https://www.pewresearch.org/short-reads/2015/05/08/ideal-size-of-the-american-family/).\n\nHouseholds are also aging in Hampton Roads. From 2010 to 2021, there was an increase of nearly 60,000 householders age 65 or older. There was only an increase of about 5,000 householders between the ages of 45 to 64 years old, while there was a net loss of householders 44 years old or younger. The loss of younger households in the region has significant impacts on the vitality of the region, leading to decreases in the labor force and tax base. As noted by Hamilton Lombard of the University of Virginia Weldon Cooper Center for Public Service, [\"The military brings lots of young people to the area... but the region doesn't offer enough other opportunities to retain them.\"](https://whro.org/news/local-news/40455-migration-into-flood-prone-areas-has-skyrocketed-but-hampton-roads-bucks-national-trend-new-analysis-shows?utm_source=enewsletter&utm_medium=enews&utm_term=text&utm_campaign=230816)\n\n```{r}\n#| label: fig-age\n#| fig-cap: \"Change in householders by age in Hampton Roads\"\n\nhr_age <- read_rds(\"data/hr/rds/hr_b25007.rds\") |> # Load in saved data for age of householders in Hampton Roads.\n  mutate(age = case_when( # Create fewer age groupings.\n    age == \"Householder 15 to 24 years\" ~ \"34 years or below\",\n    age == \"Householder 35 to 44 years\" ~ \"35 to 44 years\",\n    age == \"Householder 45 to 54 years\" ~ \"45 to 64 years\",\n    age == \"Householder 55 to 59 years\" ~ \"45 to 64 years\",\n    age == \"Householder 60 to 64 years\" ~ \"45 to 64 years\",\n    TRUE ~ \"65 years and over\"\n  )) |> \n  group_by(year, age) |> # Group by age year and age.\n  summarise(estimate = sum(estimate)) |> # Aggregate.\n  filter(year == 2010 | year == 2021) |> # Filter for latest and earliest year.\n  pivot_wider(names_from = year, # Pivot to calculate the change.\n              values_from = estimate) |> \n  mutate(chg = `2021` - `2010`) # Caclulate the change from 2010 to 2021.\n\nsubtitle_text <- \"<span style = 'color:#259591'><b>Senior households</b></span> have grown <b>significantly</b> from 2010 to 2021\"\n\nggplot(hr_age,\n       aes(x = age,\n           y = chg,\n           fill = age)) + \n  geom_col() +\n  geom_text(aes(label = number_format(big.mark = \",\", \n                                      style_positive = \"plus\", \n                                      style_negative = \"minus\")(chg), \n                hjust = ifelse(chg >= 0, 0, 1), color = age)) +\n  coord_flip() + \n  theme_hfv() +\n  scale_fill_hfv() +\n  scale_color_hfv() +\n  labs(title = \"Change in householders by age\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** U.S. Census Bureau, ACS, 5-Year Estimates, Table B25007.\") +\n  scale_y_continuous(labels = number_format(big.mark = \",\", style_positive = \"plus\", style_negative = \"minus\"), limits = c(-10000, 70000), breaks = seq(-10000, 70000, by = 10000)) + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#f5f5f5\",size = 0.1)) +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    )))\n  \n```\n\n```{r}\n#| label: household-size-data\n#| fig-cap: \"Change in household size by tenure in Hampton Roads\"\n\n# Create a visualization that shows the change in household size from 2010 to 2021 in each locality. Describe the trend in household size changes. Where are larger households seeing growth? Smaller households?\n\nhr_hhsize <- read_rds(\"data/hr/rds/hr_hhsize.rds\") |> # Read in household size data.\n  group_by(NAME, year, size) |> # Aggregate to locality, year, and household size.\n  summarise(estimate = sum(estimate)) |> \n  filter(year == 2010 | year == 2021) |> # Filter for latest and earliest years.\n  mutate(year = as.character(year)) |> # Convert year to a character.\n  pivot_wider(names_from = year,\n              values_from = estimate) |> \n  mutate(change = `2021` - `2010`) |> # Calculate the change from 2010 to 2021.\n  group_by(NAME) |> # Group by locality. \n  mutate(total_chg = sum(change)) |> # Calculate total change in order to order bar chart.\n  mutate(NAME = str_remove_all(NAME, \" city\")) # Remove \" city\" from all locality names.\n  \nsubtitle_text <- \"<span style = 'color:#011E41'><b>1-person</b></span> and <span style = 'color:#40C0C0'><b>2-person</span> households have grown the most from 2010 to 2021\"\n  \nggplot(hr_hhsize,\n       aes(x = reorder(NAME, total_chg),\n           y = change,\n           fill = size)) +\n  geom_col(position = \"stack\") +\n  theme_hfv() +\n  coord_flip() +\n  facet_wrap(~size, nrow =1) +\n  scale_fill_hfv() +\n  labs(title = \"Change in household size in Hampton Roads\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** U.S. Census Bureau. ACS 5-Year Estimates. Table B25009.\") +\n  add_zero_line(axis = \"y\") +\n  scale_y_continuous(labels = number_format(big.mark = \",\", style_positive = \"plus\")) + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#f5f5f5\",size = 0.1)) +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    )))\n\n```\n\nAs many households age, many are also shrinking in size. From 2010 to 2021, the greatest increases in households were among 1- and 2-person households. These increases were most prevalent in the cities of Virginia Beach, Chesapeake, Norfolk, Suffolk, and Newport News. Three- or more person households saw little growth during this timeframe, and in some cases experienced declines, particularly in Newport News, Portsmouth, York County, and Gloucester County.\n\nShrinking household size has real impacts on housing demand. Not only does it mean more homes are needed for more people, it also means that smaller-sized homes are needed. Diverse options provide flexibility for the ways in which households form or change, whether it be through marriage and kids, adult children moving out or in, a spouse passing away, or even just downsizing for better livability.\n\nThese trends among many others are drive housing demand. As you read further, it is important to ask, \"Is the region's housing meeting the demands of the population?\"\n\n## Housing Market\n\n```{r}\n#| label: fig-bps-hr\n#| fig-cap: \"Total new residential building permits issued from 2010 to 2022\"\n\n# Create a visualization that shows where housing is being built. Where is more diverse housing being built? Where is single-family housing being built the most? How does that compare to population growth in those localities?\n\nhr_bps <- read_rds(\"data/hr/rds/hr_bps.rds\") |> # Load in Building Permits Survey data.\n  mutate(type = case_when( # Group \"Missing Middle\" housing together.\n    type == \"2-units\" ~ \"2-4 units\",\n    type == \"3-4 units\" ~ \"2-4 units\",\n    TRUE ~ type\n  )) |> \n  group_by(name_long, type) |> # Aggregate to locality and housing type.\n  summarise(units = sum(units)) |> \n  group_by(name_long) |> # Group by locality.\n  mutate(total = sum(units)) |> # Calculate the total number of new permits for entire time period.\n  mutate(name_long = str_remove(name_long, \" City\")) |> # Remove \" City\" from locality names.\n  mutate(name_long = case_when( # Add \"City\" back to James City County.\n    name_long == \"James County\" ~ \"James City County\",\n    TRUE ~ name_long\n  ))\n\n# Summarize the percentage of units developed by type for the narrative.\n\nhr_bps_summary <- hr_bps |> \n  group_by(type) |> # Aggregate by housing type.\n  summarise(units = sum(units)) |> \n  mutate(pct = units/sum(units)) # Calculate the percentage of type of units for the region.\n\nsubtitle_text <- \"Few, if any, <span style = 'color:#40C0C0'><b>2-4 unit housing</span> has been built between 2010 to 2022\"\n  \nbps_plot <- ggplot(hr_bps,\n       aes(x = reorder(name_long, total),\n           y = units,\n           fill = type,\n           data_id = units,\n           tooltip = number_format(big.mark =\",\")(units))) + \n  geom_col_interactive(position = \"stack\") +\n  coord_flip() +\n  facet_wrap(~type) +\n  theme_hfv() + \n  scale_fill_hfv() +\n  scale_y_continuous(labels = number_format(big.mark = \",\", style_positive = \"plus\")) +\n  labs(title = \"Total new residential building permits issued in Hampton Roads\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** U.S. Census Bureau. Building Permits Survey.\") + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#f5f5f5\",size = 0.1),\n        axis.text.x = element_text(angle = 90)) +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    )))\n\ngirafe(ggobj = bps_plot,\n       height_svg = 4)\n\n\n```\n\nThe bulk of new residential permits from 2010 to 2022 were single-family housing (64%), while most of the 5+ multifamily housing was constructed in Virginia Beach and Norfolk during this time. Throughout the region, few if any 2-4 unit housing (2%), typically referred to as [Missing Middle Housing](https://wparch.com/projects/urban-design-planning/missing-middle-pattern-book/), was constructed.\n\nBefore the pandemic, home prices throughout the median single-family home price was \\$250,000 in Q2 2019. Record low interest rates in across the nation during the pandemic led to a heated housing market as many millennials entered homeownership. With interest rate increases in recent months, the home sales have decreased, but prices and competition have not.\n\nAs of Q2 2023, the median home price in the region sits at \\$335,000. The biggest jumps in price were in James City County, Williamsburg, and Surry County. James City County has the highest median home price in the region at \\$459,000, followed by York County (\\$410,560) and Poquoson (\\$400,000).\n\n```{r}\n#| label: fig-hr-price\n#| fig-cap: \"Median home sales price in Hampton Roads\"\n\n# What have home prices been like?\n\n# How to add arrows indicating direction on line segments??\n\nhr_var_price <- read_rds(\"data/hr/rds/hr_var.rds\") |> \n  select(geography, period, name, adj_price) |> \n  mutate(year = substr(period, 1, 4)) |> \n  mutate(year = as.numeric(year)) |> \n  filter(period == \"2023 Q2\" | period == \"2019 Q2\") |> \n  mutate(period = as.character(period)) |> \n  select(geography, name, adj_price, period) |> \n  pivot_wider(names_from = period, \n              values_from = adj_price) |> \n  mutate(latest = `2023 Q2`) |> \n  pivot_longer(3:4,\n               names_to = \"period\",\n               values_to = \"med_price\") |> \n  mutate(name = case_when(\n    name == \"Virginia Beach-Norfolk-Newport News MSA\" ~ \"VB-Norfolk-NN MSA\",\n    TRUE ~ name\n  )) |> \n  mutate(name = str_remove(name, \" City\"))  |> \n  mutate(name = case_when(\n    name == \"James County\" ~ \"James City County\",\n    TRUE ~ name\n  ))\n  \nsubtitle_text <- \"In <span style = 'color:#011E41'><b>Q2 2019</b></span> and <span style = 'color:#40C0C0'><b>Q2 2023</span>\"\n\n\nprice_plot <- ggplot(hr_var_price,\n       aes(x = reorder(name, latest),\n           y = med_price,\n           color  = period)) +\n  theme_hfv() +\n  geom_line(linewidth = 1, color = \"grey\") +\n  geom_point_interactive(aes(\n           data_id = med_price,\n           tooltip = dollar_format()(med_price))) +\n  geom_text(data = subset(hr_var_price, \n                          name %in% c(\"James City County\",  \"VB-Norfolk-NN MSA\", \"Portsmouth\")),\n            aes(label = dollar(med_price),\n                hjust = ifelse(period == \"2023 Q2\", -0.25, 1.25)), \n            size = 3) +\n  coord_flip() +\n  labs(title = \"Median home sales price in Hampton Roads\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** Virginia REALTORS, adjusted to Q2 2023 dollars.\") +\n  scale_y_continuous(labels = dollar_format(), limits = c(100000, 500000)) +\n  scale_color_hfv() +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    ))) + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#dadada\",size = 0.2))\n  \ngirafe(ggobj = price_plot,\n       height_svg = 4)\n\n```\n\nDays on Market (DOM) is an indicator of how long it takes for a home to sell after being listed. Lower DOM can be indicative of higher demand and a heated market. A median DOM of 30 has been [suggested as indicating a balanced market](https://virginiarealtors.org/2022/04/14/is-five-months-of-supply-really-the-sign-of-a-healthy-housing-market/#:~:text=One%20possibility%20would%20be%20to,around%2030%20was%20in%202017). Before the pandemic (Q2 2019), the median days on market in many localities sat around 30. As of Q2 2023, the majority of localities have a median DOM below 15 days. In higher priced markets like Williamsburg, James City County, York County, and Virginia Beach, the median DOM is fewer than 10 days.\n\n```{r}\n#| label: fig-hr-dom\n#| fig-cap: \"Median days on market in Hampton Roads\"\n\n# What has for-sale home supply been like?\n\n# How to add arrows indicating direction on line segments??\nsubtitle_text <- \"In <span style = 'color:#011E41'><b>Q2 2019</b></span> and <span style = 'color:#40C0C0'><b>Q2 2023</span>\"\n\nlibrary(patchwork)\n\nhr_var_dom <- read_rds(\"data/hr/rds/hr_var.rds\") |> \n  select(geography, name, period, med_dom)  |> \n  mutate(year = substr(period, 1, 4)) |> \n  mutate(year = as.numeric(year)) |> \n  filter(period == \"2023 Q2\" | period == \"2019 Q2\") |> \n  mutate(period = as.character(period)) |> \n  select(geography, name, med_dom, period) |> \n  pivot_wider(names_from = period, \n              values_from = med_dom) |> \n  mutate(latest = `2023 Q2`) |> \n  pivot_longer(c(`2023 Q2`, `2019 Q2`),\n               names_to = \"period\",\n               values_to = \"med_dom\") |> \n  mutate(name = case_when(\n    name == \"Virginia Beach-Norfolk-Newport News MSA\" ~ \"VB-Norfolk-NN MSA\",\n    TRUE ~ name\n  )) |> \n  mutate(name = str_remove(name, \" City\"))  |> \n  mutate(name = case_when(\n    name == \"James County\" ~ \"James City County\",\n    TRUE ~ name\n  ))\n\ndom_plot <- ggplot(hr_var_dom,\n       aes(x = reorder(name, -latest),\n           y = med_dom,\n           color = period)) +\n  geom_line(size = 1, color = \"grey\") +\n  geom_point_interactive(aes(\n    data_id = med_dom,\n    tooltip = med_dom)) +\n  theme_hfv() +\n  geom_text(data = subset(hr_var_dom, \n                          name %in% c(\"Williamsburg\",  \"VB-Norfolk-NN MSA\", \"Surry County\")), \n            aes(label = med_dom, hjust = ifelse(period == \"2023 Q2\", 1.50, -0.5)),\n            size = 3) +\n  coord_flip() +\n  labs(title = \"Median days on market in Hampton Roads\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** Virginia REALTORS.\")  +\n  scale_y_continuous(limits = c(0, 130)) +\n  scale_color_hfv() +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    ))) + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#dadada\",size = 0.2))\n\ngirafe(ggobj = dom_plot,\n       height_svg = 4)\n  \n\n\n\n```\nWith increasing challenges to homeownership, the percentage of renters has been growing in nearly every Hampton Roads locality, with the Cities of Franklin and Williamsburg and James City County being the exceptions. The biggest leaps in the percentage of renters were in Newport News, Portsmouth, Suffolk, and York County. The increasing number of renters across the region has resulted in high rental demand and higher rental prices. \n\n```{r}\n#| label: fig-pct-renter\n#| fig-cap: \"Percent of renter households in Hampton Roads\"\n\nhr_tenure <- read_rds(\"data/hr/rds/hr_b25003.rds\") |> \n  filter(year == 2010 | year == 2021) |> \n  filter(tenure == \"Renter\") |> \n  mutate(year = as.character(year)) |> \n  mutate(NAME = str_remove(NAME, \" city\"))\n\nsubtitle_text <- \"In <span style = 'color:#011E41'><b>2010</b></span> and <span style = 'color:#40C0C0'><b>2021</span>\"\n\ntenure_plot <- ggplot(hr_tenure,\n       aes(x = reorder(NAME, pct),\n           y = pct,\n           color = year)) +\n  geom_line(size = 1, color = \"grey\") +\n  geom_point_interactive(aes(color = year,\n                             data_id = pct,\n                             tooltip = percent_format(accuracy = 1)(pct)), \n                         size = 2) +\n  coord_flip() +\n  theme_hfv() +\n  scale_y_continuous(labels = percent_format()) +\n  labs(title = \"Percent of renter households in Hampton Roads\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** U.S. Census Bureau, ACS, 5-Year Estimates, Table B25003.\") +\n  scale_color_hfv() +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    ))) + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#dadada\",size = 0.1))\n\ngirafe(ggobj = tenure_plot,\n       height_svg = 4)\n\n\n```\n\nThe Hampton Roads rental market experienced stark changes during the COVID-19 pandemic, with significant leaps in average asking rent from 2021 to 2022. Previously, average asking rent had increased by \\$10 to \\$30 annually, but from 2021 to 2022, rent had increased by over \\$100. By the second quarter of 2023, average asking rent stood at \\$1,384. To afford this without being financially strained, a household would need an annual income of \\$55,360.\n\n**For context, the HUD Area Median Income (AMI) limit for a two-person household at 50% AMI in the region is \\$37,400.**\n\n```{r}\n#| label: fig-hr-rent\n#| fig-cap: \"Average asking rent in Hampton Roads\"\n\n# What has rent been like in Hampton Roads?\n\nhr_rent <- read_rds(\"data/hr/rds/hr_costar.rds\") |> \n  select(period, rent, adj_price) |> \n  mutate(quarters = as.yearqtr(period)) |> \n  pivot_longer(2:3,\n               names_to = \"rent\",\n               values_to = \"dollars\")\n\nsubtitle_text <- \"In <span style = 'color:#011E41'><b>Q2 2023 dollars</b></span> and <span style = 'color:#40C0C0'><b>current dollars</span>\"\n\nrent_plot <- ggplot(hr_rent,\n       aes(x = quarters,\n           y = dollars,\n           color = rent,\n           linetype = rent)) +\n  geom_line() +\n  geom_point_interactive(aes(\n    data_id = dollars,\n    tooltip = dollar_format()(dollars)\n  )) +\n  theme_hfv() +\n  scale_y_continuous(labels = dollar_format()) +\n  scale_x_yearqtr(breaks = seq(from = min(hr_rent$quarters), \n                               to = max(hr_rent$quarters), \n                               by = 1),format = '%Y-Q%q') +\n  theme(axis.text.x = element_text(angle = 90)) +\n  labs(title = \"Average asking rent in Hampton Roads\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** CoStar Group, Inc.\") +\n  scale_color_hfv()  +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    ))) + \n  theme(panel.grid.major.y = element_line(color = \"#dadada\", size = 0.1),\n        panel.grid.major.x = element_line(color = \"#dadada\",size = 0.1))\n  # scale_color_gradientn(colours = c(\"#ADDCB1\", \"#46A88F\", \"#207A88\", \"#0F1A4E\"))\n\ngirafe(ggobj = rent_plot,\n       height_svg = 4)\n\n```\n\nThe rising rental prices are a sign of increasing demand. Subsequently, rental vacancy rates took a tumble from 2020 to 2021, with a historic low of 3.2% in Q2 and Q3 of 2021. Vacancy rates have since increased to 5.7% in Q2 2023 - still lower than any quarter before 2019.\n\n```{r}\n#| label: fig-hr-rv\n#| fig-cap: \"Rental vacancy in Hampton Roads\"\n\n\n# What has rental vacancy been like?\n\nhr_rv <- read_rds(\"data/hr/rds/hr_costar.rds\") |> \n  select(period, vacancy_rate) |> \n  mutate(quarters = as.yearqtr(period))\n\nvacancy_plot <- ggplot(hr_rv,\n       aes(x = quarters,\n           y = vacancy_rate,\n           color = vacancy_rate)) +\n  geom_line() +\n  geom_point_interactive(aes(\n    data_id = vacancy_rate,\n    tooltip = percent_format(accuracy = 0.01)(vacancy_rate)\n  )) +\n  theme_hfv() +\n  scale_y_continuous(labels = percent_format()) +\n  scale_x_yearqtr(breaks = seq(from = min(hr_rv$quarters), to = max(hr_rv$quarters), by = 1),\n                  format = '%Y-Q%q') +\n  theme(axis.text.x = element_text(angle = 90)) +\n  labs(title = \"Rental vacancy rate in Hampton Roads\",\n       caption = \"**Source:** CoStar Group, Inc.\") + \n  scale_color_gradientn(colours = c(\"#ADDCB1\", \"#46A88F\", \"#207A88\", \"#0F1A4E\"))\n\ngirafe(ggobj = vacancy_plot,\n       height_svg = 4)\n\n\n```\n\n## Jobs Market\n\nThe importance of affordable housing to a thriving economy cannot be overstated, as it directly impacts various facets of economic well-being. By providing stable living conditions and reducing the financial burden on households, affordable housing enhances workforce productivity and stability, ensuring that employees can live close to their workplaces. This proximity not only reduces commuting times but also supports local businesses and stimulates economic growth. Moreover, affordable housing fosters economic mobility, allowing individuals and families to invest in education, job training, and entrepreneurship, ultimately leading to higher incomes and reduced reliance on social services. Affordable housing is an economic catalyst that promotes financial security, encourages consumer spending, and contributes to a more equitable and thriving economy for all.\n\nA Jobs-Housing Fit ratio helps measure the imbalance between low-wage jobs and housing that is affordable to those jobs. \n\n-   The ratio is calculated by dividing the number of low-wage jobs by the number of housing units that are affordable at that wage level.\n-   A ratio of 1.0 would mean a perfect fit: one low-wage job for each affordable housing unit, assuming one worker per household.\n-   Ratios closer to 1.0 or 2.0 are generally considered more balanced. They indicate that the local housing market is better suited to meet the needs of low-wage earners.\n-   High ratios, such as 5.0, indicate an imbalance. In this case, there are five low-wage jobs for every one unit of affordable housing, suggesting that many workers may have to commute from other areas or choose housing that is unaffordable to them.\n\nFor example, a ratio of 5.0 means that there are five low-wage jobs for every unit of housing that is affordable at that wage. Ratios closer to 1.0 or 2.0 offer more balance assuming that there is only one worker per household. When ratios are high, this means that more low-wage workers need to commute in for work, putting additional pressure on Hampton Roads traffic. But keep in mind that these ratios are at the jurisdiction-level.\n\n```{r}\n#| label: fig-jobs-housing\n#| fig-cap: \"Jobs-Housing Fit in Hampton Roads\"\n\n\n# What have employment levels been like? Are jobs declining or growing?\n\nhr_jhf <- read_rds(\"data/hr/rds/hr_ratio.rds\") \n\nggplot(hr_jhf,\n       aes(x = reorder(name_long, ratio),\n           y = ratio,\n           fill = ratio)) +\n  geom_col(position = \"dodge\") +\n  geom_text(aes(label = round(ratio, 2), color = ratio), hjust = -0.1) +\n  coord_flip() + \n  theme_hfv() +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +\n  labs(title = \"Jobs-Housing Fit in Hampton Roads.\",\n       caption = \"**Source:** U.S. Census Bureau. Longitudinal Employer-Household Dynamics & ACS, 5-Year Estimates, Table B25056 and B25061.\") + \n  scale_fill_gradientn(colours = c(\"#ADDCB1\", \"#46A88F\", \"#207A88\", \"#0F1A4E\")) + \n  scale_color_gradientn(colours = c(\"#ADDCB1\", \"#46A88F\", \"#207A88\", \"#0F1A4E\"))\n\n\n\n```\n\nAs the jobs market shifts with the changing economy, we can better see the balance or imbalance at the Census Block Group-level. The Census Block Group is a more reasonable way to measure the Jobs-Housing Fit ratio as it can better account for employment centers at the neighborhood-scale. Locating jobs closer to housing means shorter commute times for workers, but also overall reductions in traffic congestion. Public transportation infrastructure close to where low wage workers live and work can further help with economic stability and reduced traffic.\n\n:::{.callout-note}\n## Jobs-Housing Fit In Hampton Roads\n\nThe map below shows the job-housing fit ratio at the Census Block Group-level based on a median earnings in 2020 for individuals with a high school degree in the Virginia Beach-Norfolk-Newport News, VA-NC Metro Area (Virginia part), which was \\$32,507. Affordable rent at this earnings would be \\$812.67.\n\nAreas that are marked as NA have no affordable units.\n:::\n\nMany localities in Hampton Roads seemingly have a balanced ratio as a whole, but drilling down to the community-level shows that almost all localities have imbalanced areas (i.e. areas that have more low wage workers than housing affordable to those workers).\n\n```{r}\n#| label: fig-hr-ratio-map\n#| fig-cap: \"Jobs-Housing Fit Ratio in Hampton Roads by Block Group\"\n\nhr_blk_grps <- read_rds(\"data/hr/rds/hr_blk_grps.rds\")\n\nlibrary(RColorBrewer)\n\nrc1 <- colorRampPalette(colors = c(\"#8B85CA\", \"#ADDCB1\"), space = \"Lab\")(10)\n\n## Make vector of colors for values larger than 0 (180 colors)\nrc2 <- colorRampPalette(colors = c(\"#ADDCB1\", \"#011E41\"), space = \"Lab\")(30)\n\n## Combine the two color palettes\nrampcols <- c(rc1, rc2)\n\nratio_bins <- c(0, 0.5, 1, 2, 5, 10, 50, 100, 550)\n\npal <- colorBin(palette = rampcols, bins = ratio_bins, domain = (hr_blk_grps$ratio), na.color = \"#011E41\")\n\nleaflet(hr_blk_grps,) |> \n  addPolygons(\n              fillColor = ~pal(ratio),\n              fillOpacity = 0.8,\n              color = \"white\",\n              weight = 1,\n              popup = paste0(\n                \"Jurisdiction: \",\n                hr_blk_grps$name_long,\n                \"<br>\",\n                \"Ratio: \", hr_blk_grps$label\n              )\n              ) |> \n  addTiles() |> \n  addLegend(title = \"Jobs-Housing Fit\",\n            \"bottomright\", \n            pal = pal, \n            values = ~ratio,\n            opacity = 1\n  )\n\n\n```\n\nFour of the top five industry occupations in the region have an annual median wage below \\$40,000. In order to not be cost-burdened, these occupations need a rent that ranges from \\$681 to \\$952, a rent that is hard to come by in the region. While Business and Financial Operations occupations can more than afford the average asking rent in the region (\\$1,384), they still find it difficult to find an affordable home to purchase in the region.\n\n```{r}\n#| label: tbl-local-wages\n#| tbl-cap: \"Top 5 occupations in Hampton Roads in 2022\"\n\n# What can current wages afford in Hampton Roads?\n\nlibrary(formattable)\n\nhr_occ <- read_rds(\"data/hr/rds/hr_occ.rds\") |> \n  select(occ_title, emp = tot_emp_2022, wage = a_median_2022, rent, ho_price) |> \n  mutate(`Total Employment` = label_number(big.mark = \",\")(emp),\n         `Average Annual Wage` = dollar_format()(wage),\n         `Affordable Rent` = dollar_format()(rent),\n         `Affordable Home Price` = dollar_format()(ho_price)) |> \n  select(Industry = occ_title, `Total Employment`, `Average Annual Wage`, `Affordable Rent`, `Affordable Home Price`)\n         \n\nhr_occ_tbl <- hr_occ |> \n  kable(col.names = c(\n    \"Industry\",\n    \"Total Employment\",\n    \"Annual Median Wage\",\n    \"Affordable Rent\",\n    \"Affordable Home Price\"),\n    align = \"lcccc\"\n  ) |> \n  kableExtra::kable_styling(\n    bootstrap_options = c(\"hover\", \"condensed\", \"responsive\", \"striped\")\n    )\n\nhr_occ_tbl\n\n# unit.scale = function(x) (x - min(x)) / (max(x) - min(x))\n# \n# occ_table <- formattable(\n#   hr_occ,\n#   align = c(\"l\", \"c\", \"c\", \"c\", \"c\"),\n#   list(\n#     Industry = formatter(\"span\", style = ~style(color = \"grey\", font.weight = \"bold\")), \n#        `Total Employment` = color_bar(\"#ADDCB1\", fun = unit.scale)))\n# \n# \n# occ_table\n\n```\n\n::: callout-note\n\n### Measuring affordability\n\nDetermining what is affordable to a person can depend on a multitude of factors, but for the purposes of this analysis we made several assumptions to make informed estimates.\n\nFor renters, we calculated what a monthly rent at 30 percent of an individual's gross income. This is based on the Department of Housing and Urban Development's (HUD) definition of affordable housing.\n\nFor homebuyers, we calculated a home price based on a 30-year fixed rate mortgage at 7.18% (which was the U.S. weekly average as of August 31, 2023), a 3% minimum down payment, and a monthly tax and insurance of \\$250. In addition, we assumed that a household would pay no more than 28 percent of their gross income due to lender preference for the [28/36 rule](https://www.businessinsider.com/personal-finance/28-36-rule-mortgages).\n\n:::\n\n\n```{r}\n#| label: tbl-renter-income\n#| tbl-cap: \"What can the typical renter afford in Hampton Roads?\"\n\n\n# What are renter incomes like? What can a renter afford to rent and buy?\n\nhr_income <- read_rds(\"data/hr/rds/hr_income.rds\") |> \n  select(NAME, estimate, rent, ho_price) |> \n  mutate(estimate = dollar_format()(estimate),\n         rent = dollar_format()(rent),\n         ho_price = dollar_format()(ho_price)) |> \n  mutate(NAME = str_remove(NAME, \", Virginia\"),\n         NAME = str_remove(NAME, \" city\")) |> \n  arrange(desc(estimate))\n\nhr_income |> \n  kable(col.names = c(\n    \"Jurisdiction\",\n    \"Median Renter Household Income\",\n    \"Affordable Rent\",\n    \"Affordable Home Price\"),\n    align = \"lccc\"\n  ) |> \n  kableExtra::kable_styling(\n    bootstrap_options = c(\"hover\", \"condensed\", \"responsive\", \"striped\")\n    ) \n  \n\n```\n\nThe typical renter in most localities would struggle to afford the average asking rent (\\$1,384 in Q2 2023) in the region and would struggle further to afford homeownership. Even with a higher median renter income in jurisdictions like Poquoson, York County, and Virginia Beach, renter households still face challenges. Based on these incomes, the typical renter could not afford the median sales price in the region of \\$335,000. At best, the typical renter in Poquoson could afford the median sales price in Portsmouth, but nowhere else.\n\nAffordability challenges have continuously affected renter households the most in Hampton Roads. Over 50 percent of renters in the region are cost-burdened compared to 23 percent of homeowners. In recent years, cost burden has been affecting more and more higher income households. These trends can be directly tied to an increasing number of higher income households competing in the rental market due to lifestyle choices, but more often challenges in the homeownership market.\n\nThis places downward pressure on market affordable rental housing, forcing lower and middle-income households to compete with higher income households for quality rental housing stock. These challenges have also increased the number of single-family home rentals across the nation --- further limiting the supply of resale housing, which is often more affordable than new construction.\n\n```{r}\n#| label: fig-hr-cb\n#| fig-cap: \"Cost burden by income and tenure in Hampton Roads\"\n\n# What is cost burden like in the region?\n\nhr_cb <- read_rds(\"data/hr/rds/hr_cb.rds\")|> \n  mutate(income = case_when(\n    income == \"Less than $20,000\" ~ \"Less than $35,000\",\n    income == \"$20,000 to $34,999\" ~ \"Less than $35,000\",\n    TRUE ~ income\n  )) |> \n  group_by(year, tenure, income, cb) |> \n  summarise(estimate = sum(estimate)) |> \n  group_by(year, tenure) |> \n  mutate(pct = estimate/sum(estimate)) |> \n  filter(cb == \"Cost-burdened\") |> \n  mutate(year = as.character(year))\n\n\nggplot(hr_cb,\n       aes(x = year,\n           y = pct, \n           fill = (factor(income, levels = c(\"Less than $35,000\", \"$35,000 to $49,999\", \"$50,000 to $74,999\", \"$75,000 or more\"))))) +\n  geom_col(position = position_stack(reverse = TRUE)) +\n  facet_wrap(~tenure) +\n  labs(title = \"Cost burden by income in Hampton Roads\",\n       subtitle = \"*Percent of total households by tenure*\",\n       caption = \"**Source:** U.S. Census Bureau, ACS, 5-Year Estimates, Table B25106.\") +\n  theme_hfv() +\n  scale_fill_hfv() +\n  scale_y_continuous(labels = percent_format(), breaks = seq(0, 0.6, by = .10), limits = c(0, 0.6)) +\n  theme(legend.position = \"right\",\n        axis.text.x = element_text(angle = 90, vjust = 0.5))\n  \n\n```\nHousing affordability in Hampton Roads is also an issue of racial equity. In the region, the typical Black households makes over $33,000 less than the typical white household. This wide wealth gap has persisted across time and contributes to a disproportionate number of individuals identifying as Black represented in [Point-in-Time counts of homelessness](https://www.hamptonroadsendshomelessness.org/) and housing cost burden.\n\n```{r}\n#| label: fig-race-inc\n#| fig-cap: \"Median household income by race and ethnicity in Hampton Roads\"\n\n# Should probably consider adding in something about median household income by race in the region?\n\nhr_race_inc <- read_rds(\"data/hr/rds/hr_b19013.rds\") |> \n  filter(year == 2021)\n\nsubtitle_text <- \"In 2021, the wealth gap between <span style = 'color:#B1005F'><b>WHITE</b></span> and <span style = 'color:#40C0C0'><b>BLACK</span> households was <b>over $33,000 </b>\"\n\nggplot(hr_race_inc,\n       aes(x = reorder(race, estimate),\n           y = estimate,\n           fill = race)) +\n  geom_col(position = \"dodge\") +\n  theme_hfv() +\n  scale_fill_hfv() +\n  coord_flip() +\n  scale_y_continuous(labels = dollar_format(), expand = expansion(mult = c(0, 0.1))) + \n  theme(panel.grid.major.y = element_line(color = \"white\"),\n        panel.grid.major.x = element_line(color = \"#f5f5f5\",size = 0.1)) +\n  labs(title = \"Median household income by race and ethnicity\",\n       subtitle = subtitle_text,\n       caption = \"**Source:** U.S. Census Bureau, ACS, 5-Year Estimates, Table B19013B-H.\") +\n  plot_annotation(\n    theme = theme(\n    plot.subtitle = element_markdown(\n       margin = margin(b = 0.4, unit = 'cm'),\n        size = 11.5\n    )))\n\n```\nBased on these median household incomes, what a typical Black household could afford in terms of rent and home purchase would far less than the typical white household. While a typical Black household in 2021 would barely be able to afford the average asking rent during that period, the typical white household would have no issue. In terms of home purchase, the average white household in the region could afford over \\$100,000 more than a Black household.\n\n```{r}\n#| label: fig-race-afford\n#| fig-cap: \"Housing affordability by race and ethnicity\"\n\n# Should probably consider adding in something about median household income by race in the region?\n\nhr_race_inc <- read_rds(\"data/hr/rds/hr_b19013.rds\") |> \n  filter(year == 2021) |> \n  select(race, rent, ho_price) |> \n  mutate(rent = dollar(rent),\n         ho_price = dollar(ho_price))\n\nhr_race_inc <- hr_race_inc[order(hr_race_inc$rent, decreasing = TRUE),]\n\nhr_race_inc |> \n  kable(row.names = FALSE,\n        col.names = c(\"Household Race/Ethnicity\", \"Affordable Rent\", \"Affordable Home Price\"),\n        align = \"lcc\") |> \n  kableExtra::kable_styling(\n    bootstrap_options = c(\"hover\", \"condensed\", \"responsive\", \"striped\")\n    )\n```\n\nWith a wide racial wealth gap and increasing housing costs, the issue of more diverse housing is also an issue of racial and ethnic diversity. With a prevalence of single-family detached housing that is becoming more and more out of reach for many, the exclusion of diverse housing effectively excludes diverse populations."},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"part-2-1.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","knitr":{"opts_chunk":{"echo":false,"warning":false,"message":false}},"theme":["lumen","custom.scss"],"grid":{"sidebar-width":"350px"},"fontsize":"100%","template-partials":["toc.html"],"toc-title":"On this page"},"extensions":{"book":{"multiFile":true}}}}}