# Zoning in Northern Virginia {part-3-2}

```{r}
#| label: setup

library(tidyverse)
library(tidycensus)
library(ggplot2)
library(ggiraph)
library(sf)
library(leaflet)
library(FinCal)
library(hdatools)
library(scales)
library(forcats)
library(kableExtra)
library(ggtext)
library(patchwork)
library(forcats)
# Summarize the key findings from the analysis below.

# Describe the housing market in relation to population growth and household trends in the region. 

# Is the population growing or snovainking? What is the typical household size?
# Are we building the housing to match the growth and typical household?

# Describe economic trends in the region.

# Is there job growth in the region? Are incomes and wages growing or declining?
# What can the typical renter afford to buy or rent?
# What can the top occupations afford to buy or rent?

# Describe zoning's impact in Hampton Roads.

# How much of zoned land in Hampton Roads is dedicated to single-family housing only (% of total acres)? Total and by locality. Ranked.
# How much of zoned land in Hampton Roads is primarily residential, mixed with residential, and nonresidential (% of total acres)? Total and by locality. Ranked.
# How much of zoned land in Hampton Roads allows for 2+ family by-right (% of total acres)?
# Housing type by-right by locality
# Where are there minimum square footage requirements?
# How much of zoned land in Hampton Roads allows for ADUs by-right?
# What is the average minimum lot acres for each treatment?


```

### Data collection



### Sponsors


## Key findings


## Zoning's impact in Northern Virginia



## Zoning ordinances in Hampton Roads

```{r}
#| label: tbl-nova-zoning-summary
#| tbl-cap: "Summary of zoning ordinances in Northern Virginia"

# Read in csv of zoning summary for Northern Virginia.

nova_zoning_summary <- read_csv("data/nova/nova_zoning_summary.csv")

nova_zoning_summary |> 
  kbl(col.names = c("Jurisdiction", "County or equivalent", "Government Type", "Date of Zoning Ordinance", "Number of Pages", "Number of base and overlay districts"), align = "lllccc") |> 
  kable_styling(bootstrap_options = c("striped", "condensed"))

```


## Type of zoning district

```{r}
#| label: fig-housing-type
#| fig-cap: "Percent of land zoned by residential category"

# Create a bar chart that shows the percentage of zoned in each locality by type (i.e. primarily residential, mixed with residential, nonresidential)

nova_type <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, type, acres)


nova_type_summary <- nova_type |> 
  filter(jurisdiction != "Quantico") |> 
  filter(jurisdiction != "Hillsboro") |> 
  group_by(jurisdiction, type) |> 
  summarise(acres = sum(acres)) |> 
  group_by(jurisdiction) |> 
  mutate(pct = acres/sum(acres)) 

write_csv(nova_type_summary, "data/nova/nova_ztype.csv")

nova_summary <- nova_type |> 
  group_by(type) |> 
  summarise(acres = sum(acres)) |> 
  mutate(pct = acres/sum(acres)) 

write_csv(nova_summary, "data/nova/nova_ztype_region.csv")

subtitle_text <- "<span style='color:#8B85CA'><b>Primarily Residential</span></b>, <span style='color:#40C0C0'><b>Mixed with Residential</span></b>, and <span style='color:#011E41'><b>Nonresidential</span></b>"


type_plot <- ggplot(nova_type_summary,
       aes(x = fct_reorder2(jurisdiction, type, pct),
           y = pct,
           fill = factor(type, levels = c("Nonresidential", "Mixed with Residential", "Primarily Residential")),
           data_id = pct,
           tooltip = percent_format(accuracy = 0.1)(pct))) +
  geom_col_interactive(position = "stack") +
  coord_flip() +
  theme_hfv() +
  scale_fill_hfv() +
  labs(title = "Percent of land by type of zoning district",
       subtitle = subtitle_text,
       caption = "**Source:** Mercatus Center at George Mason University & HousingForward Virginia, Virginia Zoning Atlas.") +
  scale_y_continuous(labels = percent_format(), expand = expansion(mult = c(0, 0.01))) +
  plot_annotation(
    theme = theme(
    plot.subtitle = element_markdown(
       margin = margin(b = 0.4, unit = 'cm'),
        size = 11.5
    )))


girafe(ggobj = type_plot,
       height_svg = 4)


```


## Single-family detached housing


```{r}
#| label: fig-sfd-map
#| fig-cap: "Single-family detached only zoning in Northern Virginia"

# Create a map that shows where single-family detached only housing districts are in the region.


vza_pal <- colorFactor(palette =c("#8B85CA", "#40C0C0", "#011E41"),
                       levels = c("Primarily Residential", "Mixed with Residential", "Nonresidential"))

nova_sfd_map <- read_rds("data/nova/nova_sfd_only_map.rds")

leaflet() |>
  addProviderTiles(providers$CartoDB.Positron) |> 
  addPolygons(data = nova_sfd_map,
              color = ~vza_pal(type),
              weight = 1,
              fillOpacity = 0.80,
              popup = paste0("Jurisdiction: ", nova_sfd_map$jurisdiction,
                             "<br>",
                             "District Abbreviation: ", nova_sfd_map$abbrvname)) |>
  addLegend(labels = c("Primarily Residential", "Mixed with Residential", "Nonresidential"),
            colors = c("#8B85CA", "#40C0C0", "#011E41"),
            title = "Type of Zoning District")


```


```{r}
#| label: fig-sfd-bar
#| fig-cap: "Percent of developable land dedicated to single-family detached only"

# Create a bar char that shows the percentage of zoned in each locality that is dedicated to single-family detached only housing.

nova_sfd <- read_rds("data/nova/nova_vza_nogeo.rds") |> # Read in the data.
  select(jurisdiction, overlay, sfd, acres) |> # Select necessary data fields.
  filter(jurisdiction != "Hillsboro") |> 
  filter(overlay == 0) |> # Remove overlay districts.
  group_by(jurisdiction, sfd) |> # Sum the total acres dedicated to single-family detached in each district.
  summarise(acres = sum(acres)) |> 
  group_by(jurisdiction) |> 
  mutate(percent = acres/sum(acres)) |> 
  ungroup() |> 
  mutate(total_nova = sum(acres)) |> # Calculate what percentage of total developable acres is SFD.
  filter(sfd == "t") 

write_csv(nova_sfd, "data/nova/nova_sfd.csv")

nova_sfd_summary <- nova_sfd |> 
  group_by(total_nova) |> 
  summarise(total_sfd = sum(acres)) |> 
  mutate(pct = total_sfd/total_nova)



ggplot(nova_sfd,
       aes(x = reorder(jurisdiction, percent),
           y = percent,
           fill = percent)) +
  geom_col(position = "dodge") +
  geom_col_interactive(position = "dodge") +
  geom_text(aes(label = percent(percent, 1), color = percent),
    hjust = -0.2) +
  theme_hfv() +
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  scale_fill_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_color_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  labs(title = "Percent of developable land dedicated to single-family detached only",
       caption = "**Source:** Mercatus Center at George Mason University & HousingForward Virginia, Virginia Zoning Atlas.") +
  theme(axis.text.x = element_blank())

```

```{r}
#| label: fig-bipoc-sfd
#| fig-cap: "Percentage of SFD-only land compared to BIPOC population"
#| eval: false


# Read in data frame
nova_bipoc <- read_rds("data/nova/nova_bipoc.rds") |>
  st_drop_geometry() |>
  arrange(name_long) |>
  mutate(bipoc = percent) |>
  select(fips, name_long, bipoc)

nova_sfd <- read_rds("data/nova/nova_vza_nogeo.rds") |> # Read in the data.
  select(county, overlay, sfd, acres)|> # Select necessary data fields.
  filter(county != "Hillsboro") |> 
  filter(overlay == 0) |> # Remove overlay districts.
  group_by(county, sfd) |> # Sum the total acres dedicated to single-family detached in each district.
  summarise(acres = sum(acres)) |>
  group_by(county) |>
  mutate(percent = acres/sum(acres)) |> # Calculate what percentage of total developable acres is SFD.
  filter(sfd == "t") |>
  ungroup() 

nova_sfd_arrange <- nova_sfd |>
  arrange(county)

sfd_bipoc <- cbind(nova_bipoc, nova_sfd_arrange) |>
  mutate(sfd = percent) |>
  select(county, bipoc, sfd) |>
  pivot_longer(4:5,
               names_to = "metric",
               values_to = "pct") |>
  mutate(metric = case_when(
    metric == "bipoc" ~ "BIPOC population (% of total)",
    metric == "sfd" ~ "Single-family detached only (% of total developable)"))


ggplot(sfd_bipoc,
       aes(x = fct_reorder2(county, metric, pct),
           y = pct,
           fill = metric)) +
  geom_col(position = "dodge") +
  theme_hfv() +
  coord_flip() +
  scale_y_continuous(labels = percent_format())+
  theme(legend.position = "top") +
  scale_fill_hfv() +
  labs(title = "Percentage of SFD-only land compared to BIPOC population")



```


### Minimum lot sizes


This provides a general range of the minimum lot acres required for housing in single-family detached only zoning districts.
:::

```{r}
#| label: fig-sfd-min
#| fig-cap: "Average minimum lot acres requirements in single-family detached only districts"

# What is the average minimum lot size for each type of treatment? 
# Blank fields should be treated as NA and should not be included in the mean calculation.


nova_lots <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  mutate(min1 = as.numeric(min1),
         max1 = as.numeric(max1)) |> 
  group_by(jurisdiction) |> 
  summarise(mean1min = round(mean(min1, na.rm = TRUE), 2),
            mean1max = round(mean(max1, na.rm = TRUE), 2)) |> 
  mutate(max = mean1max) |> 
  pivot_longer(2:3,
               names_to = "metric",
               values_to = "avg") |> 
  mutate(metric = case_when(
    metric == "mean1min" ~ "Minimum value",
    metric == "mean1max" ~ "Maximum value"
  ))

write_csv(nova_lots, "data/nova/nova_min1_lots.csv")

subtitle_text <- "*Average <span style='color:#40c0c0'><b>minimum</span></b> and <span style='color:#011E41'><b>maximum</span></b> in acres*"
  

lot_plot <- ggplot(nova_lots,
       aes(x = reorder(jurisdiction, max),
           y = avg,
           color = metric,
           data_id = avg,
           tooltip = avg)) +
  geom_point_interactive() +
  coord_flip() +
  labs(title = "Mininum lot requirements in single-family detached only districts",
       subtitle = subtitle_text,
       caption = "**Source:** Mercatus Center at George Mason University & HousingForward Virginia, Virginia Zoning Atlas.") +
  theme_hfv() +
  scale_y_continuous(breaks = seq(0, 10, 0.5)) +
  scale_color_hfv() +
  plot_annotation(
    theme = theme(
    plot.subtitle = element_markdown(
       margin = margin(b = 0.4, unit = 'cm'),
        size = 11.5
    )))


girafe(ggobj = lot_plot,
       height_svg = 4)

```

## By-right housing

When housing development requires a public hearing process, it can often come up against opposition from existing community members who have a preconceived notions about the impacts of increased density or new neighbors. The entitlement process, whether tnovaough a special use permit (or conditional use permit), variance, or rezoning can increase development costs and lead to project uncertainty. At a time when new housing is needed across the region, allowing for housing by-right (without a public hearing process) can streamline development and ensure that the housing supply is aligned with the demand.

```{r}
#| label: tbl-nova-byright
#| tbl-cap: "Percent of developable land that welcomes housing type by-right"

# Create a table that shows the percentage of land that allows for each type of treatment by locality
# https://frontierinstitute.org/reports/the-montana-zoning-atlas-2-0/ use this as an example 

nova_byright_tbl <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, abbrvname, overlay, 6:9, acres) |> 
  filter(overlay == 0) |>
  filter(acres != 0) |> 
  group_by(jurisdiction) |> 
  mutate(total_acres = sum(acres)) |> 
  mutate(family1_pct = case_when(
    family1_treatment == "allowed" ~ acres/total_acres,
    TRUE ~ 0
  ))|> 
  mutate(family2_pct = case_when(
    family2_treatment == "allowed" ~ acres/total_acres,
    TRUE ~ 0 
  )) |> 
  mutate(family3_pct = case_when(
    family3_treatment == "allowed" ~ acres/total_acres,
    TRUE ~ 0 
  )) |> 
  mutate(family4_pct = case_when(
    family4_treatment == "allowed" ~ acres/total_acres,
    TRUE ~ 0 
  )) |> 
  group_by(jurisdiction) |> 
  summarise(family1_byright = percent(sum(family1_pct)),
            family2_byright = percent(sum(family2_pct)),
            family3_byright = percent(sum(family3_pct)),
            family4_byright = percent(sum(family4_pct))
            ) 

write_csv(nova_byright_tbl, "data/nova/nova_byright_table.csv")

nova_byright_tbl |>
  kable(col.names = c("Jurisdiction", "Single-family", "2-family", "3-family", "4+-family"), 
        align = "lcccc") |> 
  kable_styling(bootstrap_options = c("striped", "condensed"))

```


```{r}
#| label: fig-2plus
#| fig-cap: "Percent of developable land allowing for 2+ family housing by-right" 

# Create a bar graph that shows the total amount of zoned land that welcomes 2+ family housing by-right

nova_byright <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, abbrvname, overlay, 6:9, acres) |> # Select data fields.
  filter(overlay == 0) |> # Filter out overlay districts.
  group_by(jurisdiction) |> 
  mutate(total_acres = sum(acres)) |> # Calculate the total acres of zoned land.
  filter(family2_treatment == "allowed" & family3_treatment == "allowed" & family4_treatment == "allowed") |> 
  group_by(jurisdiction) |> 
  mutate(pct_2plus = acres/total_acres) |> 
  group_by(jurisdiction) |> 
  summarise(pct_2plus = sum(pct_2plus)) 

nova_byright_summary <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, abbrvname, overlay, 6:9, acres) |> # Select data fields.
  filter(overlay == 0) |> # Filter out overlay districts.
  mutate(total_acres = sum(acres)) |> # Calculate the total acres of zoned land.
  filter(family2_treatment == "allowed" & family3_treatment == "allowed" & family4_treatment == "allowed") |> 
  mutate(total_2plus = sum(acres)) |> 
  mutate(pct2plus = total_2plus/total_acres)

write_csv(nova_byright, "data/nova/nova_byright_2plus.csv")

ggplot(nova_byright,
       aes(x = reorder(jurisdiction, pct_2plus),
           y = pct_2plus,
           fill = pct_2plus)) +
  geom_col() +
  geom_text(aes(label = percent(pct_2plus, 1), color = pct_2plus),
    hjust = -0.2) +
  coord_flip() +
  theme_hfv() +
  scale_fill_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_color_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  labs(title = "Percent of developable land allowing for 2+ family housing by-right",
       caption = "**Source:** Mercatus Center at George Mason University & HousingForward Virginia, Virginia Zoning Atlas.")  +
  theme(axis.text.x = element_blank())




```

The map below shows the location of zoning districts that allow for 2+ family by-right.

```{r}
#| label: fig-byr2-map
#| fig-cap: "Developable land zoned for 2+ family housing by-right"

# Create a map that shows where 2 + family housing is allowed by-right in the region.

pal <- colorFactor(palette =c("#8B85CA", "#40C0C0"),levels = c("Primarily Residential", "Mixed with Residential"))

nova_byr2 <- read_rds("data/nova/byr_map.rds")

nova_byr2 |> 
  addProviderTiles(providers$CartoDB.Positron)

```


```{r}
#| label: fig-4plus
#| fig-cap: "Percent of developable land allowing for 4+ family housing by-right" 

# Create a bar graph that shows the total amount of zoned land that welcomes 2+ family housing by-right

nova_byright <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, abbrvname, overlay, 6:9, acres) |> # Select data fields.
  filter(overlay == 0) |> # Filter out overlay districts.
  filter(acres != 0) |> 
  group_by(jurisdiction) |> 
  mutate(total_acres = sum(acres)) |> # Calculate the total acres of zoned land.
  filter(family4_treatment == "allowed") |> 
  group_by(jurisdiction) |> 
  mutate(pct_4plus = acres/total_acres) |> 
  group_by(jurisdiction) |> 
  summarise(pct_4plus = sum(pct_4plus)) 

write_csv(nova_byright, "data/nova/nova_byright_4plus.csv")

nova_byright_summary <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, abbrvname, overlay, 6:9, acres) |> # Select data fields.
  filter(overlay == 0) |> # Filter out overlay districts.
  mutate(total_acres = sum(acres)) |> # Calculate the total acres of zoned land.
  filter(family4_treatment == "allowed") |> 
  mutate(total_4plus = sum(acres)) |> 
  mutate(pct4plus = total_4plus/total_acres)



ggplot(nova_byright,
       aes(x = reorder(jurisdiction, pct_4plus),
           y = pct_4plus,
           fill = pct_4plus)) +
  geom_col() +
  geom_text(aes(label = percent(pct_4plus, 1), color = pct_4plus),
    hjust = -0.2) +
  coord_flip() +
  theme_hfv() +
  scale_fill_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_color_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  labs(title = "Percent of developable land allowing for 4+ family housing by-right",
       caption = "**Source:** Mercatus Center at George Mason University & HousingForward Virginia, Virginia Zoning Atlas.")+
  theme(axis.text.x = element_blank())


```

## Other requirements

```{r}

# Summarize some key requirements.

# Minimum parking requirements for 4+ family in each locality


```

### Minimum dwelling square footage



### Parking minimums



The table below shows minimum parking requirements for multifamily housing developments of 4 or more units in each Hampton Roads locality:

```{r}
#| label: tbl-min-parking
#| tbl-cap: "Minimum parking requirements for 'multifamily' housing in Hampton Roads"

nova_parking <- read_csv("data/nova/nova_vza_parking.csv")

nova_parking |> 
  kbl(col.names = c("Jurisdiction", "1-Bedroom", "2-Bedroom", "3-Bedroom", "Vistor Space/Unit"),
      align = "lcccc") |> 
  kable_styling(bootstrap_options = c("striped", "condensed"))

```


## Accessory dwelling units

Accessory dwelling units (ADUs) have been a growing interest among homeowners as they look for ways to increase income, house a family member with special needs, or simply make their home more functional for their family.

:::{.callout-caution}
## About ADUs in the methodology!

Remember that the National Zoning Atlas Methodology includes caretaker or watchman's quarters associated with a nonresidential use. It also includes a single dwelling above a commercial or retail use.
:::

```{r}
#| label: fig-nova-adus
#| fig-cap: "Percent of developable land that allows for ADUs by-right"

# Create a table that shows the percentage of land that allows for ADUs by-right
# https://frontierinstitute.org/reports/the-montana-zoning-atlas-2-0/ use this as an example 

nova_adu <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(jurisdiction, overlay, accessory_treatment, acres) |> 
  filter(overlay == 0) |> 
  group_by(jurisdiction) |> 
  mutate(total_acres = sum(acres)) |> 
  filter(accessory_treatment == "allowed") |> 
  group_by(jurisdiction, total_acres)  |> 
  summarise(acres = sum(acres)) |> 
  mutate(pct = acres/total_acres) |> 
  ungroup() |> 
  filter(jurisdiction != "Hillsboro") |> 
  filter(jurisdiction != "Quantico")

write_csv(nova_adu, "data/nova/nova_adu.csv")


ggplot(nova_adu,
       aes(x = reorder(jurisdiction, pct),
           y = pct,
           fill = pct)) +
  geom_col() +
  geom_text(aes(label = percent(pct, accuracy = 0.1), color = pct, hjust = -0.2)) +
  coord_flip() +
  theme_hfv() +
  labs(title = "Percent of developable land allowing for ADUs by-right",
       caption = "**Source:** HousingForward Virginia, Virginia Zoning Atlas.")  +
  scale_y_continuous(labels = percent_format(), expand = expansion(mult = c(0, 0.15))) +
  scale_fill_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_color_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  theme(axis.text.x = element_blank())
  

```

For a more focused understanding, particularly for those who associate ADUs primarily with single-family homes, we can omit zones that are Mixed Residential{.mixed-res} and Nonresidential{.non-res}. The figure below shows the percentage of developable land that allows for ADUs by-right in Primarily Residential{.primary-res} districts.

```{r}
#| label: fig-nova-adus-exc
#| fig-cap: "Percent of developable land that allows for ADUs by-right, excluding Mixed with Residential and Nonresidential"

# Create a table that shows the percentage of land that allows for ADUs by-right
# https://frontierinstitute.org/reports/the-montana-zoning-atlas-2-0/ use this as an example 

nova_adu <- read_rds("data/nova/nova_vza_nogeo.rds") |> 
  select(type, jurisdiction, overlay, accessory_treatment, acres) |> 
  filter(overlay == 0) |> 
  group_by(jurisdiction) |> 
  mutate(total_acres = sum(acres)) |> 
  filter(accessory_treatment == "allowed") |> 
  group_by(jurisdiction, type, total_acres)  |> 
  summarise(acres = sum(acres)) |> 
  mutate(pct = acres/total_acres) |> 
  ungroup() |>
  filter(type == "Primarily Residential") 

write_csv(nova_adu, "data/nova/nova_adu_primary_res.csv")

ggplot(nova_adu,
       aes(x = reorder(jurisdiction, pct),
           y = pct,
           fill = pct)) +
  geom_col() +
  geom_text(aes(label = percent(pct, accuracy = 0.1), color = pct, hjust = -0.2)) +
  coord_flip() +
  theme_hfv() +
  labs(title = "Percent of developable land allowing for ADUs by-right in Primarily Residential",
       caption = "**Source:** HousingForward Virginia, Virginia Zoning Atlas.")  +
  scale_y_continuous(labels = percent_format(), expand = expansion(mult = c(0, 0.1))) +
  scale_fill_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  scale_color_gradientn(colours = c("#ADDCB1", "#46A88F", "#207A88", "#0F1A4E")) + # Use custom HFV gradient.
  theme(axis.text.x = element_blank())
  

```

Many localities across Hampton Roads address ADUs in their zoning ordinances. It is also important to note that while localities may be generous with the allowance of ADUs, others place additional restrictions on how they can be used. Some jurisdictions require an additional administrative process, like a specific [ADU permit](https://library.municode.com/va/poquoson/codes/code_of_ordinances?nodeId=PTIICOOR_APXAZO_ARTXIIACDW_S12-20ANPERE) or an [affidavit certifying information](https://library.municode.com/va/williamsburg/codes/code_of_ordinances?nodeId=PTIITHCO_CH21ZO_ARTIVSUDIRE_S21-604ACAP) provided in the Board of Zoning Appeals hearing that allowed for the ADU.

:::{.callout-note}
## Notable Jurisdictions

The Town of Surry, Newport News, and Chesapeake do not allow for ADUs at all.

The City of Virginia Beach is notable because it has two different instances of ADUs in its zoning ordinance: [Flex Suites](https://library.municode.com/va/virginia_beach/codes/code_of_ordinances?nodeId=CO_APXAZOOR_ART5REDI_S507FLSU) and [ancillary single-family dwellings](https://library.municode.com/va/virginia_beach/codes/code_of_ordinances?nodeId=CO_APXAZOOR_ART19OLBEOVDI_S1903USRE).
:::

```{r}
#| label: tbl-nova-adu-restrictions
#| tbl-cap: "Summary of ADU regulations in Hampton Roads"

# Create a table for the following csv.
# https://frontierinstitute.org/reports/the-montana-zoning-atlas-2-0/ use this as an example 

nova_adu_summary <- read_csv("data/nova/nova_adu_summary.csv") |> 
  select(jurisdiction, attached, detached, owner_occupancy, rental_prohibition, elderly_family, admin_permit)

nova_adu_summary |> 
  kable(col.names = c("Jurisdiction", "Attached Allowed", "Detached Allowed", "Owner Occupancy Requirement", "Rental Prohibited", "Elderly or Family Requirement", "Administrative Permit")) |> 
  kable_styling(bootstrap_options = c("striped", "condensed"))

```

ADU regulations aren't standard across the region, while some do not even allow for them. Places like Newport News could benefit from ADUs to support an aging population.

![Where ADUs are allowed by-right, excluding Mixed with Residential and Nonresidential Districts](img/nova/adu_highlight.png){fig-align="center"}

```{r}
#| label: fig-adu-map
#| fig-cap: "Where ADUs are allowed by-right"

nova_adu_map <- read_rds("data/nova/nova_adu_map.rds")

pal <- colorFactor(palette =c("#8B85CA", "#40C0C0", "#011E41"),levels = c("R", "M", "X"))

nova_adu_map |> 
  addProviderTiles(providers$CartoDB.Positron)

```

## Access to transit

Access to frequent and efficient public transportation can help entire regions reduce congestion, improve access to job opportunities, and make for more vibrant communities. By building diverse types of housing along transit lines, localities can better connect residents to opportunity and foster less of a reliance on personal vehicle travel.

[Transit oriented development (TOD)](https://www.transit.dot.gov/TOD) maximizes a mix of land uses within walking distance of public transit. Sustainable growth strategies, like TOD, are already utilized in Norfolk, as well as in Chesapeake, with their [Transportation Corridor Overlay District (TCOD)](https://www.cityofchesapeake.net/700/Transportation-Corridor-Overlay-District).

The following map shows zoned land that allows for 2+ family housing by-right in Hampton Roads with the location of Hampton Roads Transit bus stops. A quarter mile buffer, which is typically the minimum distance people will walk to a transit stop, are included.

```{r}
#| label: fig-transit-map
#| fig-cap: "Northern Virginia transit stops and zoned land allowing for 2+ family housing by-right"

pal <- colorFactor(palette =c("#8B85CA", "#40C0C0"),levels = c("Primarily Residential", "Mixed with Residential"))

transit_pal <-colorFactor(palette = c("#B1005F", "#E0592A"), levels = c("Bus", "Rail"))

nova_transit_map <- read_rds("data/nova/nova_transit_map.rds")

nova_transit_map |> 
  addProviderTiles(providers$CartoDB.Positron)

```

This map shows that many 2+ housing options are made available within bus stops, but there are still opportunities to increase transit access throughout the region by upzoning in strategic areas and/or expanding transit service.

## Affordable housing need

Housing affordability is important to households at all income-levels. But for low-wage workers, affordable housing can prevent housing instability in times of personal or economic crisis. Housing at higher densities often faces opposition from existing residents due to misconceptions about its impact on their community. The public approval process often prevents this type of housing from being constructed, especially affordable housing, in places where low-income households need it the most.

The map below shows Census Block Groups where the jobs-housing fit ratio is greater than 2.0 (i.e. where there are more than two low-wage workers for every unit of affordable rental housing) or NA (i.e. where there are no units affordable to low-wage workers). And it shows where 4+ family housing can be built by-right.

```{r}
#| label: fig-by4-jhf
#| fig-cap: "Zoning districts allowing for 4+ family by-right and Census Block Groups with a Jobs-Housing Fit above 2.0"

housing_needed <- read_rds("data/nova/nova_blk_grps.rds") |> 
  filter(ratio > 2 | is.na(ratio))

pal <- colorFactor(palette =c("#8B85CA", "#40C0C0"),levels = c("Primarily Residential", "Mixed with Residential"))

nova_byr4 <- read_rds("data/nova/nova_byr4_map.rds") 

fit_map <- nova_byr4 |> 
  addPolygons(data = housing_needed,
              fillColor = "#66788d",
              fillOpacity = 0.5,
              color = "white",
              weight = 1,
              popup = paste0(
                "Jurisdiction: ",
                housing_needed$name_long,
                "<br>",
                "Ratio: ", housing_needed$label),
              group = "Jobs-Housing Fit Ratio") |> 
  addLegend(data = housing_needed,
            position = "topright",
            colors = "#66788d",
            labels = "Ratio > 2 or NA")

fit_map |> 
  addProviderTiles(providers$CartoDB.Positron)
```

There are many acress of the region where 4+ family must go tnovaough the public approval process, particularly in acress where it is needed the most. 

## What now?

There are many localities and states taking on zoning reforms to better have their housing supply meet the demands and needs of their communities.

Visit our [Zoning Reform Efforts](https://housingforwardva.org/focused-initiatives/zoning/reform-tracker/) to learn more on how these zoning reforms are being implemented.


